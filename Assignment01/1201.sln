// See https://aka.ms/new-console-template for more information
//初始化数据
using System.Data;
using System.Text;

void WriteCSV()
{
    //获取dataGridView1的数据源
    DataTable dt = dataGridView1.DataSource as DataTable;
    //文件流写入
    System.IO.FileStream fs = new System.IO.FileStream("d:\\1.csv", System.IO.FileMode.OpenOrCreate);
    System.IO.StreamWriter sw = new System.IO.StreamWriter(fs, Encoding.GetEncoding("gb2312"));


    //将表头写入文件第一行
    string dcStr = "";
    foreach (DataColumn dc in dt.Columns)
    {
        dcStr += dc.ColumnName + ",";
    }
    sw.WriteLine(dcStr);


    //将每行数据写入文件
    string drStr = "";
    foreach (DataRow dr in dt.Rows)
    {
        foreach (DataColumn dc in dt.Columns)
        {
            drStr += dr[dc] + ",";
        }
        sw.WriteLine(drStr);
        drStr = "";
    }
    void BindData()
    {
        //初始化DataTable数据
        DataTable dts = new DataTable();
        dts.Columns.Add("姓名");
        dts.Columns.Add("密码");

        dts.Rows.Add(fs, GenerateEncryptedPassword(fs));
        //将数据显示到dataGridView1
        dataGridView1.DataSource = dts;
    }


    //输出缓冲区内的数据
    sw.Flush();
    //释放流
    sw.Close(); fs.Close();
}
